%-*- coding: UTF-8 -*-
% preamble.tex
% 复杂导言区
\usepackage{amssymb}
\usepackage{overpic}     %图片上写文字
\usepackage{float}         %浮动
\usepackage{graphicx}
\usepackage{amsmath}       %公式
\usepackage[table]{xcolor}
\usepackage{enumitem}
\usepackage{lipsum}
\usepackage[backref]{hyperref}
%\usepackage[atend]{bookmark}
\usepackage{booktabs}
\usepackage[squaren]{SIunits}
\usepackage{fontspec}
\usepackage{tikz}
%\usepackage[dutch]{babel}
%%%%%%%%%%%%%%%目录%%%%%%%%%%%%%%%%%%%
\usepackage{titletoc}
\titlecontents{section}[0pt]{\addvspace{2pt}\filright}
{\bfseries\contentspush{\bfseries{\thecontentslabel}\hspace{1.2mm}\ }}
{}{\titlerule*[8pt]{\bf{.}}\hspace{-0.8em}\bf{\contentspage}}

%%%%%%%%%%%%颜色%%%%%%%%%%%%%%%%
\definecolor{ZLGblack}{RGB}{0,0,0}
\definecolor{ZLGgray}{RGB}{222,222,222}
\definecolor{gray}{RGB}{222,222,222}
%%%%%%%%%%%%定义中文斜体%%%%%%%%%%%%%%%%%%
\usepackage{xeCJK}
\setCJKmainfont[BoldFont = STZhongsong, ItalicFont = STKaiti]{STSong}

%%%%%%%%%%%%%%寄存器表格%%%%%%%
\heavyrulewidth = 0.08em %\toprule线宽
\lightrulewidth = 0.08em %\midrule线宽
\belowrulesep = 0pt %线后间距
\belowbottomsep = 100pt % 表后空距离
\abovetopsep = 10pt %表前空距离

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%% 表格%%%%%%%%%%%
\usepackage{longtable}
\usepackage{textcomp}
\usepackage{multirow,makecell}
%\usepackage{caption2}
\usepackage{array}
\usepackage{tabularx}
\usepackage{multicol}
\usepackage{tabularx}
\usepackage{diagbox}
\usepackage[hypcap]{caption}
\usepackage{colortbl}
\usepackage{framed}
\usepackage{tcolorbox}
%\usepackage{fontspec}
\DeclareCaptionFont{hei}{\heiti}
\setlength{\intextsep}{1pt plus 1pt minus 1pt}
\definecolor{mygray}{gray}{.9}
\definecolor{mypink}{rgb}{.99,.91,.95}
\definecolor{mycyan}{cmyk}{.3,0,0,0}
\setlength\LTpre{5pt}      %长表格与上文的距离
\setlength\LTpost{-20pt}    %长表格与下文的距离


\renewcommand\figureautorefname{图}
\renewcommand\tableautorefname{表}
%\renewcommand{\captionlabeldelim}{.}
\newfloat{flowchart}{H}{loflow}
% [section]
\floatname{flowchart}{表}
\floatstyle{plaintop}
\restylefloat{flowchart}
\newcommand\regDes[1]
{
\begin{center}
	{
%		\rowcolors{2}{table_old_color}{table_even_color} %enable colors
		\begin{longtable*}[c]{p{40pt}p{60pt}p{40pt}p{40pt} p{252pt}}
			\hline\hline
			\rowcolor{mygray}
			\begin{minipage}{1.5cm} \vspace{0.2cm} {\bfseries Bit} \vspace{0.2cm}\end{minipage} &
			\bfseries Field & \bfseries Type & \bfseries Reset & \bfseries  Description \\ 
			\hline\hline
			\endhead
			
			\hline\hline
			\endlastfoot
			
			#1
		\end{longtable*}
	}
\end{center}
}

\newcommand\regOverview[2]
{\begin{center}
		\captionsetup{
			margin=0cm,
			labelsep=period,
			labelfont=bf,
			labelfont=hei,
			textfont=bf,
			textfont=hei,}
		\setlength{\abovecaptionskip}{0pt}%    
		\setlength{\belowcaptionskip}{0pt}
		\small
		
		\begin{longtable}{|
p{80pt}p{90pt}p{200pt - 50pt}p{20pt + 40pt}p{49pt}}
			
			\caption{#1} \\
			\hline\hline
			\rowcolor{mygray} 
			
			\begin{minipage}{1.5cm} \vspace{0.2cm} {\bfseries Offset} \vspace{0.2cm}\end{minipage} 	&
			\bfseries Acronym          																&
			\bfseries Register Name    																&
			\bfseries Reset            																&
			\bfseries Section					 													\\
			
			\hline\hline
			\endfirsthead
			
			
			\hline\hline
			\rowcolor{mygray} 
			
			\begin{minipage}{1.5cm} \vspace{0.2cm} {\bfseries Offset} \vspace{0.2cm}\end{minipage} 	&
			\bfseries Acronym          																&
			\bfseries Register Name    																&
			\bfseries Reset            																&
			\bfseries Section					 													\\
			
			\hline\hline
			\endhead
			
			\hline\hline
			\endfoot
             #2
		\end{longtable}
\end{center}}

\newcommand\tabpro[1]{ 
		\small     \renewcommand\arraystretch{0.9}
	\setlength{\abovecaptionskip}{0pt}%    
	\setlength{\belowcaptionskip}{0pt}}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{ragged2e}
\usepackage[squaren]{SIunits}
% 
\usepackage{geometry}
\geometry{a4paper,left=1.905cm,right=1.905cm,top=2.5cm,bottom=1cm}

\renewcommand\subsubsectionautorefname{小节}
\renewcommand\subsectionautorefname{节}
\renewcommand\sectionautorefname{章}
%



\renewcommand\figureautorefname{图}
\newcommand\fullPic[3]{ \begin{figure}[H]
      
      
     \setlength{\abovecaptionskip}{-5pt}  %图片标题与图片的据距离
     \setlength{\belowcaptionskip}{0pt}
   \captionsetup{
 	justification=centering,
   	labelsep=period,
   	labelfont=bf,
   	labelfont=hei,
   	textfont=bf,
   	textfont=hei,
   	margin={0pt,0pt}}
       \hspace{-6pt}
         \includegraphics{#2}

        \caption{#1} 
 \label{#3}
\end{figure}}


\newcommand\smallPic[3]{ \begin{figure}[H]
	%	\raggedleft
  		\hspace{38pt}
		\setlength{\abovecaptionskip}{0pt} 
		\setlength{\belowcaptionskip}{0pt} 
   	    \captionsetup{
		justification=centering,
		labelsep=period,
		labelfont=bf,
		labelfont=hei,
		textfont=bf,
		textfont=hei,
		margin={0pt,0pt}}
		\includegraphics{#2}
		\caption{#1} 
		\label{#3}
	\end{figure}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{txfonts}
\usepackage{ctex}


\hypersetup{
    hidelinks,
    colorlinks = true,
	linkcolor = blue,
    bookmarks = true,
    bookmarksopen = false,
    bookmarksnumbered = true,
    pdfborder = 000
}


%%%%%%%%%%%%%%%%%页眉页脚%%%%%%%%%%%%%

\usepackage{url}
\headsep=25pt
\voffset=-10pt

\usepackage{bookmark}
\usepackage{microtype}
\usepackage{times}
\usepackage[utf8]{inputenc}
\usepackage{lipsum}
\usepackage{calc}
\usepackage{xcolor}
\usepackage{lastpage}
\usepackage{fancyhdr}%
\pagestyle{fancy}%
\setlength\fboxsep{0.8pt}
\setlength\fboxrule{0.25pt}
\fancyhf{}%
\renewcommand{\headrulewidth}{0pt}
\newcommand{\yemei}{\fontsize{9}{9}\selectfont}

%\fancyhead[L]{{\includegraphics[scale=0.7]{img/zlg.pdf}}{\color{ZLGblack}  \bfseries \heiti 广州周立功微电子科技有限公司 
%		\makebox[29em][r]{\heiti \Large ZLG1x6 }\vspace{2pt}}
%	{\hrule height 0 pt\vspace{0pt}}{\colorbox{ZLGblack}
%		{\makebox[46em]{}}{\hrule height 0 pt\vspace{0pt} }}
%	\color{ZLGblack}\rule[1pt]{10pt}{10pt}\color{ZLGblack1}\rule[1pt]{10pt}{10pt}}

%\fancyhead[R]{\makebox[44em][r]{\color{ZLGblack} \small \heiti 基于ARM Cortex M0核的32位微控制器}}		

\fancyhead[L]{{{\makebox[50em][l]{\Large   \bfseries \heiti HPMicro微控制器测试指南}
        }
        {\normalsize \heiti FUSE与基本功能验证 Rev1.0\makebox[2.8em][r]{}} {\small  \heiti \color{black} \hfill \leftmark }\vspace{3pt}}
    {\hrule height 0 pt\vspace{0pt}}{{\includegraphics[width=480pt]{../common/img/hpmhead.png}}}}
%\fancyhead[R]{\leftmark}
%页脚信息修改
%\fancyfoot[L]{{\color{ZLGblack} {\bfseries \heiti 产品数据手册}
%		\makebox[130pt][r] \small \copyright2019 Guangzhou ZLG Microelectronics Technology Co., Ltd.\vspace{1pt}}
%	{\hrule height 0 pt\vspace{0pt}}
%	{\colorbox{ZLGblack}{\makebox[46em]{}}{\hrule height 0 pt\vspace{5pt}}}
%	{\makebox[46em][c]{\small  \thepage/\pageref{LastPage}}} }

    \fancyfoot[L]{{\color{ZLGblack} {{\includegraphics[scale=0.07]{../common/img/hpmlogo.eps}}}
        \makebox[205pt][r]{} {\small \color{gray} \copyright Shanghai HPMICRO Semiconductor Co., Ltd.}\vspace{0.5pt}}
    {\hrule height 0 pt\vspace{0pt}}
    {\colorbox{ZLGblack}{\makebox[46em]{}}{\hrule height 0 pt\vspace{3pt}}}
    {\makebox[46em][c]{\small  \thepage/\pageref{LastPage}}} }
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%正文%%%%%%%%%%%%%
\usepackage{indentfirst}
\renewcommand\labelitemi{●}
\setlist[itemize,1]{
	itemindent=0cm,
	leftmargin=4em,
	itemsep=0pt,
	listparindent=0cm,
	partopsep=0pt,
	parsep=0pt,
	topsep=0pt
}
\setlist[itemize,2]{
	leftmargin=2em,
	before=\setlength{\rightmargin}{\leftmargin},
	itemindent=0cm,
	itemsep=0pt,
	listparindent=0cm,
	partopsep=0pt,
	parsep=0pt,
	topsep=0pt
}      
\setCJKmainfont{SimSun}
\setmainfont{Arial}
%\setenumitem{itemindent=0cm}                 %  列出段落缩进量\topsep 列表顶部与之前内容的额外空白，不含 \baselineskip
%\partopsep 如果列表之前是一个空行，列表顶部的额外空白
%\itemsep 列表各项之间额外的垂直空白
%\parsep 一个 item 中，如果分段，段落间额外空白
%\leftmargin 列表与左边距之间的水平距离，值为非负
%\rightmargin 列表与右边距之间的水平距离，值为非负
%\itemindent 每一 item 第一行的缩进
%\listparindent 每一 item 第一行之后各行的缩进

%\setdescription{itemindent=38pt,leftmargin=0pt,itemsep=-0.4ex,listparindent=26pt,partopsep=0pt,parsep=0.5ex,topsep=-0.25ex}
\setlength{\hangindent}{6em}
\setlength\leftskip{0pt}        %正文缩进
\setlength\headsep{30pt}	    %页眉底部到页主体顶部的距离
\setlength\footskip{-0.5cm}
\setlength{\textheight}{24cm}
\setlength{\textwidth}{17.19cm} %设置文本部分的高度和宽度
\setlength{\parindent}{2em}     %段前缩进量 
\setlength{\parskip}{4pt}       %段落间距

\linespread{1.6}\selectfont          %正文单倍行距
%\newcommand{\duanluo}{\vspace{5pt}}
\newcommand\segmentSpac[3]{\vspace{#1 pt}{#2}{\vspace{#3 pt}}}
\renewcommand{\normalsize}{\fontsize{9.96}{9.96}\selectfont}
%\renewcommand{\contentsname}{\centerline{目\quad录}}
%\renewcommand\listfigurename{\centerline {插\quad图}}
%\renewcommand\listtablename{\centerline {表\quad格}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

%%%%%%%%%%%%%%%%%%%%一级标题%%%%%%%%%%%

\usepackage[explicit,newlinetospace]{titlesec}
%\usepackage{xcolor,lipsum}
\newcommand{\yiji}{\fontsize{15.96}{15.96}\selectfont}                          %一级标题15.96pt，行距15.96pt
\newcommand{\erji}{\fontsize{13.98}{13.98}\selectfont}                           %二级标题13.98pt，行距13.98pt
\newcommand{\sanji}{\fontsize{12}{12}\selectfont}                                %二级标题12pt，行距12pt

\colorlet{sectcolor}{white}


\usepackage{framed}




%\renewenvironment{leftbar}{%
%	\def\FrameCommand{{\color{orange}\hspace{25pt}\vrule width 3pt } \hspace{10pt}}%
%	\MakeFramed {\advance\hsize-\width \FrameRestore}}%
%{\endMakeFramed}
%
%
%\titleformat{\section}[hang]{}{%
%	\parbox[t]{\dimexpr0.12\linewidth-20pt\relax}{\fontsize{56}{56}\selectfont\raisebox{-1.25\height}{\hspace{25pt}\color{blue!70}\thesection}}}
%{1em}%
%{\begin{minipage}[t]{0.9\linewidth}\begin{leftbar}{\bfseries\fontsize{24}{30}\heiti \selectfont\color{black!80}
%				\rule{0pt}{2ex}\strut#1\hfil\vskip2ex\break}\sectionabstract\rule[-1.5ex]{0pt}{1.5ex}\end{leftbar}\end{minipage}
%}


%%%%%%%%%%%%%%红黑%%%%%%%%%%%%%
%\renewenvironment{leftbar}{%
%	\def\FrameCommand{{\color{red}\hspace{40pt}\vrule width 3pt } \hspace{10pt}}%
%	\MakeFramed {\advance\hsize-\width \FrameRestore}}%
%{\endMakeFramed}
%
%
%\titleformat{\section}[hang]{}{%
%	\parbox[t]{\dimexpr0.12\linewidth-20pt\relax}{\fontsize{56}{56}\selectfont\raisebox{-1.25\height}{\hspace{15pt}\color{black}\thesection}}}
%{1em}%
%{\begin{minipage}[t]{0.9\linewidth}\begin{leftbar}{\bfseries\fontsize{24}{30}\heiti \selectfont\color{black!80}
%				\rule{0pt}{2ex}\strut#1\hfil\vskip2ex\break}\sectionabstract\rule[-1.5ex]{0pt}{1.5ex}\end{leftbar}\end{minipage}
%}


\newcommand\subsec[1]{\subsection{#1}
	\setlength\LTpre{0pt}      %长表格与上文的距离
	\setlength\LTpost{-40pt}    %长表格与下文的距离
%	\begin{center}
%		\tabpro{100}
%		\begin{longtable*}{|m{375pt}<{\centering}}
%			\arrayrulecolor{gray!100}\hline
%			\\
%		\end{longtable*}
%	\end{center}
	\arrayrulecolor{black}
	\setlength\LTpre{5pt}      %长表格与上文的距离
	\setlength\LTpost{-20pt}    %长表格与下文的距离
}





%%%%%%%%%%%%%%蓝橙%%%%%%%%%%%%%%%%%%%%
%\renewenvironment{leftbar}{%
%	\def\FrameCommand{{\color{orange}\hspace{25pt}\vrule width 3pt } \hspace{10pt}}%
%	\MakeFramed {\advance\hsize-\width \FrameRestore}}%
%{\endMakeFramed}
%
%
%\titleformat{\section}[hang]{}{%
%	\parbox[t]{\dimexpr0.12\linewidth-20pt\relax}{\fontsize{56}{56}\selectfont\raisebox{-1.25\height}{\hspace{25pt}\color{blue!70}\thesection}}}
%{1em}%
%{\begin{minipage}[t]{0.9\linewidth}\begin{leftbar}{\bfseries\fontsize{24}{30}\heiti \selectfont\color{black!80}
%				\rule{0pt}{2ex}\strut#1\hfil\vskip2ex\break}\sectionabstract\rule[-1.5ex]{0pt}{1.5ex}\end{leftbar}\end{minipage}
%}




%\titleformat{\section}[display]
%{\yiji\heiti\color{black!80}\raggedright\bfseries}%\raisebox{-0.6\height}
%{\tcbset{
%		colframe=white, 
%		boxrule=0pt, 
%		left=0pt, 
%		right=0pt, 
%		top=0pt, 
%		bottom=0pt}
%	\mbox{
%		\tcbox[ 
%		boxsep=12pt, 
%		colback=orange!30,  
%		tcbox raise = 0pt]
%		{
%			\color{white}
%			\bfseries
%			\fontsize{70}{70}
%			\selectfont\thesection}
%		}
%	}
%{35pt}
%{#1\vskip-10pt\endgraf}[]


\titleformat{\section}
{\yiji\heiti\color{black!80}\raggedright\bfseries}%字体
{\thesection\hspace{1em}}{0pt}{#1}
\titlespacing*{\section} {10pt}{6pt}{0pt}             %上下间距6pt

\titleformat{\subsection}
{\erji\heiti\color{black!80}\raggedright\bfseries}
{\thesubsection\hspace{1em}}{0pt}{#1}
\titlespacing*{\subsection} {0pt}{6pt}{0pt}

\titleformat{\subsubsection}
{\sanji\heiti\color{black!80}\raggedright\bfseries}
{\thesubsubsection\hspace{1em}}{0pt}{#1}
\titlespacing*{\subsubsection} {0pt}{6pt}{0pt} 

%%%%%%%%%%%%%%%%%%%%寄存器小节%%%%%%%%%%%
\newcommand\regSec[2]{\subsubsection{#1}{\label{subsubsec:#2}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%注释%%%%%%%%%%%%%%%%%%%
\newcommand{\annotate}[1]{{\fontsize{9}{9}\selectfont\vspace{0pt}{\kaishu{#1}}}}  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%编号%%%%%%%%%%%%%%%%%%%%%%%
\setenumerate[1]{itemindent=0cm,leftmargin=4.5em,itemsep=0pt,listparindent=0cm,partopsep=0pt,parsep=0pt,topsep=0pt} 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%要点%%%%%%%%%%%%%%%%%
\usepackage{changepage}
\newcommand{\points}[1]{\begin{adjustwidth}{2em}{0pt}\vspace{0pt}\subsubsection*{#1}\vspace{-3pt}\end{adjustwidth}}  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%代码%%%%%%%%%%%%%%%%%%%%%%%%%
%\usepackage{listings}
%\newcommand\daima[1]{\begin{lstlisting}[language=C]
%    {#1}
%\end{lstlisting}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%寄存器%%%%%%%%%%%%%
\newcommand\regPic[1]{ \begin{figure}[H]
	    \vspace{10pt}
	    \hspace{0pt}
		\includegraphics{#1}
\end{figure}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{tocloft}
\setlength{\cftbeforesecskip}{5pt}

\colorlet{regOverviewColor}{orange!30}
\colorlet{regDesHeaderColor}{cyan!20}
\colorlet{table_old_color}{gray!30}
\colorlet{table_even_color}{white}
%\colorlet{regOverviewColor}{gray!30}
\endinput